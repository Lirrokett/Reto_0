CREATE DATABASE examendb;
USE examendb;

CREATE TABLE UNIDAD_DIDACTA(
ID_UNIDAD_DIDACTA INTEGER PRIMARY KEY,
ACRONIMO VARCHAR (50),
TITULO VARCHAR (50),
EVALUACION VARCHAR (50),
DESCRIPCION VARCHAR (50)
);

CREATE TABLE ENUNCIADO(
ID_ENUNCIADO INTEGER PRIMARY KEY,
DESCRIPCION VARCHAR(50),
NIVEL ENUM('Alta', 'Media', 'Baja'),
DISPONIBLE BOOLEAN,
RUTA VARCHAR(50)
);

CREATE TABLE CONTIENE(
ID_ENUNCIADO INTEGER,
ID_UNIDAD_DIDACTA INTEGER,
PRIMARY KEY (ID_ENUNCIADO, ID_UNIDAD_DIDACTA),
FOREIGN KEY (ID_ENUNCIADO) REFERENCES ENUNCIADO(ID_ENUNCIADO),
FOREIGN KEY (ID_UNIDAD_DIDACTA) REFERENCES UNIDAD_DIDACTA(ID_UNIDAD_DIDACTA)
);

CREATE TABLE CONVOCATORIA_EXAMEN(
CONVOCATORIA VARCHAR(50),
DESCRIPCION VARCHAR(50),
FECHA DATE,
CURSO VARCHAR(50),
ID_ENUNCIADO INTEGER,
FOREIGN KEY (ID_ENUNCIADO) REFERENCES ENUNCIADO(ID_ENUNCIADO)
);

INSERT INTO UNIDAD_DIDACTA (ID_UNIDAD_DIDACTA, ACRONIMO, TITULO, EVALUACION, DESCRIPCION) VALUES
(1, 'UD1', 'Introducción a SQL', 'Examen', 'Conceptos básicos de SQL'),
(2, 'UD2', 'Consultas Avanzadas', 'Práctica', 'Joins, subconsultas y funciones agregadas'),
(3, 'UD3', 'Bases de Datos Relacionales', 'Proyecto', 'Modelado relacional y normalización');

INSERT INTO ENUNCIADO (ID_ENUNCIADO, DESCRIPCION, NIVEL, DISPONIBLE, RUTA) VALUES
(1, 'Consulta simple de selección', 'Baja', TRUE, '/ruta/enunciado1.sql'),
(2, 'Join entre dos tablas', 'Media', TRUE, '/ruta/enunciado2.sql'),
(3, 'Normalización de base de datos', 'Alta', FALSE, 'src\fichs\prueba.txt');

INSERT INTO CONTIENE (ID_ENUNCIADO, ID_UNIDAD_DIDACTA) VALUES
(1, 1),
(2, 2),
(3, 3),
(2, 3); 

INSERT INTO CONVOCATORIA_EXAMEN (CONVOCATORIA, DESCRIPCION, FECHA, CURSO, ID_ENUNCIADO) VALUES
('Convocatoria Enero', 'Examen parcial de SQL', '2025-01-15', 'Base de Datos I', 1),
('Convocatoria Febrero', 'Examen práctico avanzado', '2025-02-20', 'Base de Datos II', 2),
('Convocatoria Marzo', 'Proyecto final', '2025-03-30', 'Base de Datos III', 3);

